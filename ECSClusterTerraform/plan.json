{"format_version":"1.0","terraform_version":"1.1.7","planned_values":{"outputs":{"ecr_repository_worker_endpoint":{"sensitive":false},"mysql_endpoint":{"sensitive":false}},"root_module":{"resources":[{"address":"aws_autoscaling_group.failure_analysis_ecs_asg","mode":"managed","type":"aws_autoscaling_group","name":"failure_analysis_ecs_asg","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"capacity_rebalance":null,"desired_capacity":2,"enabled_metrics":null,"force_delete":false,"force_delete_warm_pool":false,"health_check_grace_period":300,"health_check_type":"EC2","initial_lifecycle_hook":[],"instance_refresh":[],"launch_template":[],"load_balancers":null,"max_instance_lifetime":null,"max_size":10,"metrics_granularity":"1Minute","min_elb_capacity":null,"min_size":1,"mixed_instances_policy":[],"name":"asg","placement_group":null,"protect_from_scale_in":false,"suspended_processes":null,"tag":[],"tags":null,"target_group_arns":null,"termination_policies":null,"timeouts":null,"wait_for_capacity_timeout":"10m","wait_for_elb_capacity":null,"warm_pool":[]},"sensitive_values":{"availability_zones":[],"initial_lifecycle_hook":[],"instance_refresh":[],"launch_template":[],"mixed_instances_policy":[],"tag":[],"vpc_zone_identifier":[],"warm_pool":[]}},{"address":"aws_db_instance.mysql","mode":"managed","type":"aws_db_instance","name":"mysql","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"allocated_storage":5,"allow_major_version_upgrade":null,"auto_minor_version_upgrade":true,"backup_retention_period":2,"backup_window":"01:00-01:30","copy_tags_to_snapshot":false,"customer_owned_ip_enabled":null,"db_subnet_group_name":"mysql-subnet-group","delete_automated_backups":true,"deletion_protection":null,"domain":null,"domain_iam_role_name":null,"enabled_cloudwatch_logs_exports":null,"engine":"mysql","engine_version":"5.7","final_snapshot_identifier":"worker-final","iam_database_authentication_enabled":null,"identifier":"mysql","instance_class":"db.t2.micro","iops":null,"maintenance_window":"sun:03:00-sun:03:30","max_allocated_storage":null,"monitoring_interval":0,"multi_az":true,"name":"worker_db","password":"ToptoBottom123$","performance_insights_enabled":false,"port":3306,"publicly_accessible":true,"replicate_source_db":null,"restore_to_point_in_time":[],"s3_import":[],"security_group_names":null,"skip_final_snapshot":true,"storage_encrypted":null,"tags":null,"timeouts":null,"username":"worker"},"sensitive_values":{"replicas":[],"restore_to_point_in_time":[],"s3_import":[],"tags_all":{},"vpc_security_group_ids":[]}},{"address":"aws_db_subnet_group.mysql-subnet-group","mode":"managed","type":"aws_db_subnet_group","name":"mysql-subnet-group","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":"Managed by Terraform","name":"mysql-subnet-group","tags":null},"sensitive_values":{"subnet_ids":[],"tags_all":{}}},{"address":"aws_ecr_repository.worker","mode":"managed","type":"aws_ecr_repository","name":"worker","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"encryption_configuration":[],"image_scanning_configuration":[],"image_tag_mutability":"MUTABLE","name":"worker","tags":null,"timeouts":null},"sensitive_values":{"encryption_configuration":[],"image_scanning_configuration":[],"tags_all":{}}},{"address":"aws_ecs_cluster.ecs_cluster","mode":"managed","type":"aws_ecs_cluster","name":"ecs_cluster","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"configuration":[],"name":"my-cluster","tags":null},"sensitive_values":{"capacity_providers":[],"configuration":[],"default_capacity_provider_strategy":[],"setting":[],"tags_all":{}}},{"address":"aws_ecs_service.worker","mode":"managed","type":"aws_ecs_service","name":"worker","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"capacity_provider_strategy":[],"deployment_circuit_breaker":[],"deployment_controller":[],"deployment_maximum_percent":200,"deployment_minimum_healthy_percent":100,"desired_count":2,"enable_ecs_managed_tags":false,"enable_execute_command":false,"force_new_deployment":null,"health_check_grace_period_seconds":null,"load_balancer":[],"name":"worker","network_configuration":[],"ordered_placement_strategy":[],"placement_constraints":[],"propagate_tags":null,"scheduling_strategy":"REPLICA","service_registries":[],"tags":null,"timeouts":null,"wait_for_steady_state":false},"sensitive_values":{"capacity_provider_strategy":[],"deployment_circuit_breaker":[],"deployment_controller":[],"load_balancer":[],"network_configuration":[],"ordered_placement_strategy":[],"placement_constraints":[],"service_registries":[],"tags_all":{}}},{"address":"aws_ecs_task_definition.task_definition","mode":"managed","type":"aws_ecs_task_definition","name":"task_definition","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"cpu":null,"ephemeral_storage":[],"execution_role_arn":null,"family":"worker","inference_accelerator":[],"ipc_mode":null,"memory":null,"pid_mode":null,"placement_constraints":[],"proxy_configuration":[],"requires_compatibilities":null,"runtime_platform":[],"skip_destroy":false,"tags":null,"task_role_arn":null,"volume":[]},"sensitive_values":{"ephemeral_storage":[],"inference_accelerator":[],"placement_constraints":[],"proxy_configuration":[],"runtime_platform":[],"tags_all":{},"volume":[]}},{"address":"aws_iam_instance_profile.ecs_agent","mode":"managed","type":"aws_iam_instance_profile","name":"ecs_agent","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"name":"ecs-agent","name_prefix":null,"path":"/","role":"ecs-agent","tags":null},"sensitive_values":{"tags_all":{}}},{"address":"aws_iam_role.ecs_agent","mode":"managed","type":"aws_iam_role","name":"ecs_agent","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"assume_role_policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"ec2.amazonaws.com\"\n      }\n    }\n  ]\n}","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"ecs-agent","path":"/","permissions_boundary":null,"tags":null},"sensitive_values":{"inline_policy":[],"managed_policy_arns":[],"tags_all":{}}},{"address":"aws_iam_role_policy_attachment.ecs_agent","mode":"managed","type":"aws_iam_role_policy_attachment","name":"ecs_agent","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"policy_arn":"arn:aws:iam::aws:policy/service-role/AmazonEC2ContainerServiceforEC2Role","role":"ecs-agent"},"sensitive_values":{}},{"address":"aws_internet_gateway.internet_gateway","mode":"managed","type":"aws_internet_gateway","name":"internet_gateway","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"tags":null},"sensitive_values":{"tags_all":{}}},{"address":"aws_launch_configuration.ecs_launch_config","mode":"managed","type":"aws_launch_configuration","name":"ecs_launch_config","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"associate_public_ip_address":false,"enable_monitoring":true,"ephemeral_block_device":[],"iam_instance_profile":"ecs-agent","image_id":"ami-032930428bf1abbff","instance_type":"t2.micro","placement_tenancy":null,"spot_price":null,"user_data":"bdb1f81aad6e1e3c5c7fce7a79df8628d624636f","user_data_base64":null,"vpc_classic_link_id":null,"vpc_classic_link_security_groups":null},"sensitive_values":{"ebs_block_device":[],"ephemeral_block_device":[],"metadata_options":[],"root_block_device":[],"security_groups":[]}},{"address":"aws_route_table.public","mode":"managed","type":"aws_route_table","name":"public","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"route":[{"carrier_gateway_id":"","cidr_block":"0.0.0.0/0","destination_prefix_list_id":"","egress_only_gateway_id":"","instance_id":"","ipv6_cidr_block":"","local_gateway_id":"","nat_gateway_id":"","network_interface_id":"","transit_gateway_id":"","vpc_endpoint_id":"","vpc_peering_connection_id":""}],"tags":null,"timeouts":null},"sensitive_values":{"propagating_vgws":[],"route":[{}],"tags_all":{}}},{"address":"aws_route_table_association.route_table_association","mode":"managed","type":"aws_route_table_association","name":"route_table_association","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"gateway_id":null},"sensitive_values":{}},{"address":"aws_security_group.ecs_sg","mode":"managed","type":"aws_security_group","name":"ecs_sg","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"description":"Managed by Terraform","egress":[{"cidr_blocks":["0.0.0.0/0"],"description":"","from_port":0,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"tcp","security_groups":[],"self":false,"to_port":65535}],"ingress":[{"cidr_blocks":["0.0.0.0/0"],"description":"","from_port":22,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"tcp","security_groups":[],"self":false,"to_port":22},{"cidr_blocks":["0.0.0.0/0"],"description":"","from_port":443,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"tcp","security_groups":[],"self":false,"to_port":443}],"revoke_rules_on_delete":false,"tags":null,"timeouts":null},"sensitive_values":{"egress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"ingress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]},{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"tags_all":{}}},{"address":"aws_security_group.rds_sg","mode":"managed","type":"aws_security_group","name":"rds_sg","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"description":"Managed by Terraform","egress":[{"cidr_blocks":["0.0.0.0/0"],"description":"","from_port":0,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"tcp","security_groups":[],"self":false,"to_port":65535}],"ingress":[{"cidr_blocks":["0.0.0.0/0"],"description":"","from_port":3306,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"tcp","self":false,"to_port":3306}],"revoke_rules_on_delete":false,"tags":null,"timeouts":null},"sensitive_values":{"egress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"ingress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"tags_all":{}}},{"address":"aws_subnet.pub2_subnet","mode":"managed","type":"aws_subnet","name":"pub2_subnet","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"assign_ipv6_address_on_creation":false,"availability_zone":"us-east-1a","cidr_block":"10.0.2.0/24","customer_owned_ipv4_pool":null,"enable_dns64":false,"enable_resource_name_dns_a_record_on_launch":false,"enable_resource_name_dns_aaaa_record_on_launch":false,"ipv6_cidr_block":null,"ipv6_native":false,"map_customer_owned_ip_on_launch":null,"map_public_ip_on_launch":false,"outpost_arn":null,"tags":null,"timeouts":null},"sensitive_values":{"tags_all":{}}},{"address":"aws_subnet.pub_subnet","mode":"managed","type":"aws_subnet","name":"pub_subnet","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"assign_ipv6_address_on_creation":false,"availability_zone":"us-east-1b","cidr_block":"10.0.1.0/24","customer_owned_ipv4_pool":null,"enable_dns64":false,"enable_resource_name_dns_a_record_on_launch":false,"enable_resource_name_dns_aaaa_record_on_launch":false,"ipv6_cidr_block":null,"ipv6_native":false,"map_customer_owned_ip_on_launch":null,"map_public_ip_on_launch":false,"outpost_arn":null,"tags":null,"timeouts":null},"sensitive_values":{"tags_all":{}}},{"address":"aws_vpc.vpc","mode":"managed","type":"aws_vpc","name":"vpc","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"assign_generated_ipv6_cidr_block":null,"cidr_block":"10.0.0.0/16","enable_dns_hostnames":true,"enable_dns_support":true,"instance_tenancy":"default","ipv4_ipam_pool_id":null,"ipv4_netmask_length":null,"ipv6_ipam_pool_id":null,"ipv6_netmask_length":null,"tags":null},"sensitive_values":{"tags_all":{}}},{"address":"data.template_file.task_definition_template","mode":"data","type":"template_file","name":"task_definition_template","provider_name":"registry.terraform.io/hashicorp/template","schema_version":0,"values":{"filename":null,"template":"[\r\n    {\r\n        \"essential\": true,\r\n        \"memory\": 512,\r\n        \"name\": \"worker\",\r\n        \"cpu\": 2,\r\n        \"image\": \"${REPOSITORY_URL}:latest\",\r\n        \"environment\": []\r\n    }\r\n]","vars":{}},"sensitive_values":{"vars":{}}}]}},"resource_changes":[{"address":"aws_autoscaling_group.failure_analysis_ecs_asg","mode":"managed","type":"aws_autoscaling_group","name":"failure_analysis_ecs_asg","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"capacity_rebalance":null,"desired_capacity":2,"enabled_metrics":null,"force_delete":false,"force_delete_warm_pool":false,"health_check_grace_period":300,"health_check_type":"EC2","initial_lifecycle_hook":[],"instance_refresh":[],"launch_template":[],"load_balancers":null,"max_instance_lifetime":null,"max_size":10,"metrics_granularity":"1Minute","min_elb_capacity":null,"min_size":1,"mixed_instances_policy":[],"name":"asg","placement_group":null,"protect_from_scale_in":false,"suspended_processes":null,"tag":[],"tags":null,"target_group_arns":null,"termination_policies":null,"timeouts":null,"wait_for_capacity_timeout":"10m","wait_for_elb_capacity":null,"warm_pool":[]},"after_unknown":{"arn":true,"availability_zones":true,"default_cooldown":true,"id":true,"initial_lifecycle_hook":[],"instance_refresh":[],"launch_configuration":true,"launch_template":[],"mixed_instances_policy":[],"name_prefix":true,"service_linked_role_arn":true,"tag":[],"vpc_zone_identifier":true,"warm_pool":[]},"before_sensitive":false,"after_sensitive":{"availability_zones":[],"initial_lifecycle_hook":[],"instance_refresh":[],"launch_template":[],"mixed_instances_policy":[],"tag":[],"vpc_zone_identifier":[],"warm_pool":[]}}},{"address":"aws_db_instance.mysql","mode":"managed","type":"aws_db_instance","name":"mysql","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"allocated_storage":5,"allow_major_version_upgrade":null,"auto_minor_version_upgrade":true,"backup_retention_period":2,"backup_window":"01:00-01:30","copy_tags_to_snapshot":false,"customer_owned_ip_enabled":null,"db_subnet_group_name":"mysql-subnet-group","delete_automated_backups":true,"deletion_protection":null,"domain":null,"domain_iam_role_name":null,"enabled_cloudwatch_logs_exports":null,"engine":"mysql","engine_version":"5.7","final_snapshot_identifier":"worker-final","iam_database_authentication_enabled":null,"identifier":"mysql","instance_class":"db.t2.micro","iops":null,"maintenance_window":"sun:03:00-sun:03:30","max_allocated_storage":null,"monitoring_interval":0,"multi_az":true,"name":"worker_db","password":"ToptoBottom123$","performance_insights_enabled":false,"port":3306,"publicly_accessible":true,"replicate_source_db":null,"restore_to_point_in_time":[],"s3_import":[],"security_group_names":null,"skip_final_snapshot":true,"storage_encrypted":null,"tags":null,"timeouts":null,"username":"worker"},"after_unknown":{"address":true,"apply_immediately":true,"arn":true,"availability_zone":true,"ca_cert_identifier":true,"character_set_name":true,"db_name":true,"endpoint":true,"engine_version_actual":true,"hosted_zone_id":true,"id":true,"identifier_prefix":true,"kms_key_id":true,"latest_restorable_time":true,"license_model":true,"monitoring_role_arn":true,"nchar_character_set_name":true,"option_group_name":true,"parameter_group_name":true,"performance_insights_kms_key_id":true,"performance_insights_retention_period":true,"replica_mode":true,"replicas":true,"resource_id":true,"restore_to_point_in_time":[],"s3_import":[],"snapshot_identifier":true,"status":true,"storage_type":true,"tags_all":true,"timezone":true,"vpc_security_group_ids":true},"before_sensitive":false,"after_sensitive":{"password":true,"replicas":[],"restore_to_point_in_time":[],"s3_import":[],"tags_all":{},"vpc_security_group_ids":[]}}},{"address":"aws_db_subnet_group.mysql-subnet-group","mode":"managed","type":"aws_db_subnet_group","name":"mysql-subnet-group","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"Managed by Terraform","name":"mysql-subnet-group","tags":null},"after_unknown":{"arn":true,"id":true,"name_prefix":true,"subnet_ids":true,"tags_all":true},"before_sensitive":false,"after_sensitive":{"subnet_ids":[],"tags_all":{}}}},{"address":"aws_ecr_repository.worker","mode":"managed","type":"aws_ecr_repository","name":"worker","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"encryption_configuration":[],"image_scanning_configuration":[],"image_tag_mutability":"MUTABLE","name":"worker","tags":null,"timeouts":null},"after_unknown":{"arn":true,"encryption_configuration":[],"id":true,"image_scanning_configuration":[],"registry_id":true,"repository_url":true,"tags_all":true},"before_sensitive":false,"after_sensitive":{"encryption_configuration":[],"image_scanning_configuration":[],"tags_all":{}}}},{"address":"aws_ecs_cluster.ecs_cluster","mode":"managed","type":"aws_ecs_cluster","name":"ecs_cluster","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"configuration":[],"name":"my-cluster","tags":null},"after_unknown":{"arn":true,"capacity_providers":true,"configuration":[],"default_capacity_provider_strategy":true,"id":true,"setting":true,"tags_all":true},"before_sensitive":false,"after_sensitive":{"capacity_providers":[],"configuration":[],"default_capacity_provider_strategy":[],"setting":[],"tags_all":{}}}},{"address":"aws_ecs_service.worker","mode":"managed","type":"aws_ecs_service","name":"worker","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"capacity_provider_strategy":[],"deployment_circuit_breaker":[],"deployment_controller":[],"deployment_maximum_percent":200,"deployment_minimum_healthy_percent":100,"desired_count":2,"enable_ecs_managed_tags":false,"enable_execute_command":false,"force_new_deployment":null,"health_check_grace_period_seconds":null,"load_balancer":[],"name":"worker","network_configuration":[],"ordered_placement_strategy":[],"placement_constraints":[],"propagate_tags":null,"scheduling_strategy":"REPLICA","service_registries":[],"tags":null,"timeouts":null,"wait_for_steady_state":false},"after_unknown":{"capacity_provider_strategy":[],"cluster":true,"deployment_circuit_breaker":[],"deployment_controller":[],"iam_role":true,"id":true,"launch_type":true,"load_balancer":[],"network_configuration":[],"ordered_placement_strategy":[],"placement_constraints":[],"platform_version":true,"service_registries":[],"tags_all":true,"task_definition":true},"before_sensitive":false,"after_sensitive":{"capacity_provider_strategy":[],"deployment_circuit_breaker":[],"deployment_controller":[],"load_balancer":[],"network_configuration":[],"ordered_placement_strategy":[],"placement_constraints":[],"service_registries":[],"tags_all":{}}}},{"address":"aws_ecs_task_definition.task_definition","mode":"managed","type":"aws_ecs_task_definition","name":"task_definition","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"cpu":null,"ephemeral_storage":[],"execution_role_arn":null,"family":"worker","inference_accelerator":[],"ipc_mode":null,"memory":null,"pid_mode":null,"placement_constraints":[],"proxy_configuration":[],"requires_compatibilities":null,"runtime_platform":[],"skip_destroy":false,"tags":null,"task_role_arn":null,"volume":[]},"after_unknown":{"arn":true,"container_definitions":true,"ephemeral_storage":[],"id":true,"inference_accelerator":[],"network_mode":true,"placement_constraints":[],"proxy_configuration":[],"revision":true,"runtime_platform":[],"tags_all":true,"volume":[]},"before_sensitive":false,"after_sensitive":{"ephemeral_storage":[],"inference_accelerator":[],"placement_constraints":[],"proxy_configuration":[],"runtime_platform":[],"tags_all":{},"volume":[]}}},{"address":"aws_iam_instance_profile.ecs_agent","mode":"managed","type":"aws_iam_instance_profile","name":"ecs_agent","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"ecs-agent","name_prefix":null,"path":"/","role":"ecs-agent","tags":null},"after_unknown":{"arn":true,"create_date":true,"id":true,"tags_all":true,"unique_id":true},"before_sensitive":false,"after_sensitive":{"tags_all":{}}}},{"address":"aws_iam_role.ecs_agent","mode":"managed","type":"aws_iam_role","name":"ecs_agent","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assume_role_policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"ec2.amazonaws.com\"\n      }\n    }\n  ]\n}","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"ecs-agent","path":"/","permissions_boundary":null,"tags":null},"after_unknown":{"arn":true,"create_date":true,"id":true,"inline_policy":true,"managed_policy_arns":true,"name_prefix":true,"tags_all":true,"unique_id":true},"before_sensitive":false,"after_sensitive":{"inline_policy":[],"managed_policy_arns":[],"tags_all":{}}}},{"address":"aws_iam_role_policy_attachment.ecs_agent","mode":"managed","type":"aws_iam_role_policy_attachment","name":"ecs_agent","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"policy_arn":"arn:aws:iam::aws:policy/service-role/AmazonEC2ContainerServiceforEC2Role","role":"ecs-agent"},"after_unknown":{"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"aws_internet_gateway.internet_gateway","mode":"managed","type":"aws_internet_gateway","name":"internet_gateway","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"tags":null},"after_unknown":{"arn":true,"id":true,"owner_id":true,"tags_all":true,"vpc_id":true},"before_sensitive":false,"after_sensitive":{"tags_all":{}}}},{"address":"aws_launch_configuration.ecs_launch_config","mode":"managed","type":"aws_launch_configuration","name":"ecs_launch_config","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"associate_public_ip_address":false,"enable_monitoring":true,"ephemeral_block_device":[],"iam_instance_profile":"ecs-agent","image_id":"ami-032930428bf1abbff","instance_type":"t2.micro","placement_tenancy":null,"spot_price":null,"user_data":"bdb1f81aad6e1e3c5c7fce7a79df8628d624636f","user_data_base64":null,"vpc_classic_link_id":null,"vpc_classic_link_security_groups":null},"after_unknown":{"arn":true,"ebs_block_device":true,"ebs_optimized":true,"ephemeral_block_device":[],"id":true,"key_name":true,"metadata_options":true,"name":true,"name_prefix":true,"root_block_device":true,"security_groups":true},"before_sensitive":false,"after_sensitive":{"ebs_block_device":[],"ephemeral_block_device":[],"metadata_options":[],"root_block_device":[],"security_groups":[]}}},{"address":"aws_route_table.public","mode":"managed","type":"aws_route_table","name":"public","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"route":[{"carrier_gateway_id":"","cidr_block":"0.0.0.0/0","destination_prefix_list_id":"","egress_only_gateway_id":"","instance_id":"","ipv6_cidr_block":"","local_gateway_id":"","nat_gateway_id":"","network_interface_id":"","transit_gateway_id":"","vpc_endpoint_id":"","vpc_peering_connection_id":""}],"tags":null,"timeouts":null},"after_unknown":{"arn":true,"id":true,"owner_id":true,"propagating_vgws":true,"route":[{"gateway_id":true}],"tags_all":true,"vpc_id":true},"before_sensitive":false,"after_sensitive":{"propagating_vgws":[],"route":[{}],"tags_all":{}}}},{"address":"aws_route_table_association.route_table_association","mode":"managed","type":"aws_route_table_association","name":"route_table_association","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"gateway_id":null},"after_unknown":{"id":true,"route_table_id":true,"subnet_id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"aws_security_group.ecs_sg","mode":"managed","type":"aws_security_group","name":"ecs_sg","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"Managed by Terraform","egress":[{"cidr_blocks":["0.0.0.0/0"],"description":"","from_port":0,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"tcp","security_groups":[],"self":false,"to_port":65535}],"ingress":[{"cidr_blocks":["0.0.0.0/0"],"description":"","from_port":22,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"tcp","security_groups":[],"self":false,"to_port":22},{"cidr_blocks":["0.0.0.0/0"],"description":"","from_port":443,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"tcp","security_groups":[],"self":false,"to_port":443}],"revoke_rules_on_delete":false,"tags":null,"timeouts":null},"after_unknown":{"arn":true,"egress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"id":true,"ingress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]},{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"name":true,"name_prefix":true,"owner_id":true,"tags_all":true,"vpc_id":true},"before_sensitive":false,"after_sensitive":{"egress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"ingress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]},{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"tags_all":{}}}},{"address":"aws_security_group.rds_sg","mode":"managed","type":"aws_security_group","name":"rds_sg","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"Managed by Terraform","egress":[{"cidr_blocks":["0.0.0.0/0"],"description":"","from_port":0,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"tcp","security_groups":[],"self":false,"to_port":65535}],"ingress":[{"cidr_blocks":["0.0.0.0/0"],"description":"","from_port":3306,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"tcp","self":false,"to_port":3306}],"revoke_rules_on_delete":false,"tags":null,"timeouts":null},"after_unknown":{"arn":true,"egress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"id":true,"ingress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":true}],"name":true,"name_prefix":true,"owner_id":true,"tags_all":true,"vpc_id":true},"before_sensitive":false,"after_sensitive":{"egress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"ingress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"tags_all":{}}}},{"address":"aws_subnet.pub2_subnet","mode":"managed","type":"aws_subnet","name":"pub2_subnet","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assign_ipv6_address_on_creation":false,"availability_zone":"us-east-1a","cidr_block":"10.0.2.0/24","customer_owned_ipv4_pool":null,"enable_dns64":false,"enable_resource_name_dns_a_record_on_launch":false,"enable_resource_name_dns_aaaa_record_on_launch":false,"ipv6_cidr_block":null,"ipv6_native":false,"map_customer_owned_ip_on_launch":null,"map_public_ip_on_launch":false,"outpost_arn":null,"tags":null,"timeouts":null},"after_unknown":{"arn":true,"availability_zone_id":true,"id":true,"ipv6_cidr_block_association_id":true,"owner_id":true,"private_dns_hostname_type_on_launch":true,"tags_all":true,"vpc_id":true},"before_sensitive":false,"after_sensitive":{"tags_all":{}}}},{"address":"aws_subnet.pub_subnet","mode":"managed","type":"aws_subnet","name":"pub_subnet","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assign_ipv6_address_on_creation":false,"availability_zone":"us-east-1b","cidr_block":"10.0.1.0/24","customer_owned_ipv4_pool":null,"enable_dns64":false,"enable_resource_name_dns_a_record_on_launch":false,"enable_resource_name_dns_aaaa_record_on_launch":false,"ipv6_cidr_block":null,"ipv6_native":false,"map_customer_owned_ip_on_launch":null,"map_public_ip_on_launch":false,"outpost_arn":null,"tags":null,"timeouts":null},"after_unknown":{"arn":true,"availability_zone_id":true,"id":true,"ipv6_cidr_block_association_id":true,"owner_id":true,"private_dns_hostname_type_on_launch":true,"tags_all":true,"vpc_id":true},"before_sensitive":false,"after_sensitive":{"tags_all":{}}}},{"address":"aws_vpc.vpc","mode":"managed","type":"aws_vpc","name":"vpc","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assign_generated_ipv6_cidr_block":null,"cidr_block":"10.0.0.0/16","enable_dns_hostnames":true,"enable_dns_support":true,"instance_tenancy":"default","ipv4_ipam_pool_id":null,"ipv4_netmask_length":null,"ipv6_ipam_pool_id":null,"ipv6_netmask_length":null,"tags":null},"after_unknown":{"arn":true,"default_network_acl_id":true,"default_route_table_id":true,"default_security_group_id":true,"dhcp_options_id":true,"enable_classiclink":true,"enable_classiclink_dns_support":true,"id":true,"ipv6_association_id":true,"ipv6_cidr_block":true,"ipv6_cidr_block_network_border_group":true,"main_route_table_id":true,"owner_id":true,"tags_all":true},"before_sensitive":false,"after_sensitive":{"tags_all":{}}}},{"address":"data.template_file.task_definition_template","mode":"data","type":"template_file","name":"task_definition_template","provider_name":"registry.terraform.io/hashicorp/template","change":{"actions":["read"],"before":null,"after":{"filename":null,"template":"[\r\n    {\r\n        \"essential\": true,\r\n        \"memory\": 512,\r\n        \"name\": \"worker\",\r\n        \"cpu\": 2,\r\n        \"image\": \"${REPOSITORY_URL}:latest\",\r\n        \"environment\": []\r\n    }\r\n]","vars":{}},"after_unknown":{"id":true,"rendered":true,"vars":{"REPOSITORY_URL":true}},"before_sensitive":false,"after_sensitive":{"vars":{}}}}],"output_changes":{"ecr_repository_worker_endpoint":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"mysql_endpoint":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false}},"prior_state":{"format_version":"1.0","terraform_version":"1.1.7","values":{"root_module":{"resources":[{"address":"data.aws_iam_policy_document.ecs_agent","mode":"data","type":"aws_iam_policy_document","name":"ecs_agent","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"id":"1903849331","json":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"ec2.amazonaws.com\"\n      }\n    }\n  ]\n}","override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["sts:AssumeRole"],"condition":[],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[{"identifiers":["ec2.amazonaws.com"],"type":"Service"}],"resources":[],"sid":""}],"version":"2012-10-17"},"sensitive_values":{"statement":[{"actions":[false],"condition":[],"not_actions":[],"not_principals":[],"not_resources":[],"principals":[{"identifiers":[false]}],"resources":[]}]}}]}}},"configuration":{"provider_config":{"aws":{"name":"aws","expressions":{"region":{"constant_value":"us-east-1"}}}},"root_module":{"outputs":{"ecr_repository_worker_endpoint":{"expression":{"references":["aws_ecr_repository.worker.repository_url","aws_ecr_repository.worker"]}},"mysql_endpoint":{"expression":{"references":["aws_db_instance.mysql.endpoint","aws_db_instance.mysql"]}}},"resources":[{"address":"aws_autoscaling_group.failure_analysis_ecs_asg","mode":"managed","type":"aws_autoscaling_group","name":"failure_analysis_ecs_asg","provider_config_key":"aws","expressions":{"desired_capacity":{"constant_value":2},"health_check_grace_period":{"constant_value":300},"health_check_type":{"constant_value":"EC2"},"launch_configuration":{"references":["aws_launch_configuration.ecs_launch_config.name","aws_launch_configuration.ecs_launch_config"]},"max_size":{"constant_value":10},"min_size":{"constant_value":1},"name":{"constant_value":"asg"},"vpc_zone_identifier":{"references":["aws_subnet.pub_subnet.id","aws_subnet.pub_subnet"]}},"schema_version":0},{"address":"aws_db_instance.mysql","mode":"managed","type":"aws_db_instance","name":"mysql","provider_config_key":"aws","expressions":{"allocated_storage":{"constant_value":5},"backup_retention_period":{"constant_value":2},"backup_window":{"constant_value":"01:00-01:30"},"db_subnet_group_name":{"references":["aws_db_subnet_group.mysql-subnet-group.name","aws_db_subnet_group.mysql-subnet-group"]},"engine":{"constant_value":"mysql"},"engine_version":{"constant_value":"5.7"},"final_snapshot_identifier":{"constant_value":"worker-final"},"identifier":{"constant_value":"mysql"},"instance_class":{"constant_value":"db.t2.micro"},"maintenance_window":{"constant_value":"sun:03:00-sun:03:30"},"multi_az":{"constant_value":true},"name":{"constant_value":"worker_db"},"password":{"constant_value":"ToptoBottom123$"},"port":{"constant_value":"3306"},"publicly_accessible":{"constant_value":true},"skip_final_snapshot":{"constant_value":true},"username":{"constant_value":"worker"},"vpc_security_group_ids":{"references":["aws_security_group.rds_sg.id","aws_security_group.rds_sg","aws_security_group.ecs_sg.id","aws_security_group.ecs_sg"]}},"schema_version":1},{"address":"aws_db_subnet_group.mysql-subnet-group","mode":"managed","type":"aws_db_subnet_group","name":"mysql-subnet-group","provider_config_key":"aws","expressions":{"name":{"constant_value":"mysql-subnet-group"},"subnet_ids":{"references":["aws_subnet.pub_subnet.id","aws_subnet.pub_subnet","aws_subnet.pub2_subnet.id","aws_subnet.pub2_subnet"]}},"schema_version":0},{"address":"aws_ecr_repository.worker","mode":"managed","type":"aws_ecr_repository","name":"worker","provider_config_key":"aws","expressions":{"name":{"constant_value":"worker"}},"schema_version":0},{"address":"aws_ecs_cluster.ecs_cluster","mode":"managed","type":"aws_ecs_cluster","name":"ecs_cluster","provider_config_key":"aws","expressions":{"name":{"constant_value":"my-cluster"}},"schema_version":0},{"address":"aws_ecs_service.worker","mode":"managed","type":"aws_ecs_service","name":"worker","provider_config_key":"aws","expressions":{"cluster":{"references":["aws_ecs_cluster.ecs_cluster.id","aws_ecs_cluster.ecs_cluster"]},"desired_count":{"constant_value":2},"name":{"constant_value":"worker"},"task_definition":{"references":["aws_ecs_task_definition.task_definition.arn","aws_ecs_task_definition.task_definition"]}},"schema_version":0},{"address":"aws_ecs_task_definition.task_definition","mode":"managed","type":"aws_ecs_task_definition","name":"task_definition","provider_config_key":"aws","expressions":{"container_definitions":{"references":["data.template_file.task_definition_template.rendered","data.template_file.task_definition_template"]},"family":{"constant_value":"worker"}},"schema_version":1},{"address":"aws_iam_instance_profile.ecs_agent","mode":"managed","type":"aws_iam_instance_profile","name":"ecs_agent","provider_config_key":"aws","expressions":{"name":{"constant_value":"ecs-agent"},"role":{"references":["aws_iam_role.ecs_agent.name","aws_iam_role.ecs_agent"]}},"schema_version":0},{"address":"aws_iam_role.ecs_agent","mode":"managed","type":"aws_iam_role","name":"ecs_agent","provider_config_key":"aws","expressions":{"assume_role_policy":{"references":["data.aws_iam_policy_document.ecs_agent.json","data.aws_iam_policy_document.ecs_agent"]},"name":{"constant_value":"ecs-agent"}},"schema_version":0},{"address":"aws_iam_role_policy_attachment.ecs_agent","mode":"managed","type":"aws_iam_role_policy_attachment","name":"ecs_agent","provider_config_key":"aws","expressions":{"policy_arn":{"constant_value":"arn:aws:iam::aws:policy/service-role/AmazonEC2ContainerServiceforEC2Role"},"role":{"references":["aws_iam_role.ecs_agent.name","aws_iam_role.ecs_agent"]}},"schema_version":0},{"address":"aws_internet_gateway.internet_gateway","mode":"managed","type":"aws_internet_gateway","name":"internet_gateway","provider_config_key":"aws","expressions":{"vpc_id":{"references":["aws_vpc.vpc.id","aws_vpc.vpc"]}},"schema_version":0},{"address":"aws_launch_configuration.ecs_launch_config","mode":"managed","type":"aws_launch_configuration","name":"ecs_launch_config","provider_config_key":"aws","expressions":{"iam_instance_profile":{"references":["aws_iam_instance_profile.ecs_agent.name","aws_iam_instance_profile.ecs_agent"]},"image_id":{"constant_value":"ami-032930428bf1abbff"},"instance_type":{"constant_value":"t2.micro"},"security_groups":{"references":["aws_security_group.ecs_sg.id","aws_security_group.ecs_sg"]},"user_data":{"constant_value":"#!/bin/bash\necho ECS_CLUSTER=my-cluster \u003e\u003e /etc/ecs/ecs.config"}},"schema_version":0},{"address":"aws_route_table.public","mode":"managed","type":"aws_route_table","name":"public","provider_config_key":"aws","expressions":{"route":{"references":["aws_internet_gateway.internet_gateway.id","aws_internet_gateway.internet_gateway"]},"vpc_id":{"references":["aws_vpc.vpc.id","aws_vpc.vpc"]}},"schema_version":0},{"address":"aws_route_table_association.route_table_association","mode":"managed","type":"aws_route_table_association","name":"route_table_association","provider_config_key":"aws","expressions":{"route_table_id":{"references":["aws_route_table.public.id","aws_route_table.public"]},"subnet_id":{"references":["aws_subnet.pub_subnet.id","aws_subnet.pub_subnet"]}},"schema_version":0},{"address":"aws_security_group.ecs_sg","mode":"managed","type":"aws_security_group","name":"ecs_sg","provider_config_key":"aws","expressions":{"egress":{"constant_value":[{"cidr_blocks":["0.0.0.0/0"],"description":null,"from_port":0,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":65535}]},"ingress":{"constant_value":[{"cidr_blocks":["0.0.0.0/0"],"description":null,"from_port":22,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":22},{"cidr_blocks":["0.0.0.0/0"],"description":null,"from_port":443,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":443}]},"vpc_id":{"references":["aws_vpc.vpc.id","aws_vpc.vpc"]}},"schema_version":1},{"address":"aws_security_group.rds_sg","mode":"managed","type":"aws_security_group","name":"rds_sg","provider_config_key":"aws","expressions":{"egress":{"constant_value":[{"cidr_blocks":["0.0.0.0/0"],"description":null,"from_port":0,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":65535}]},"ingress":{"references":["aws_security_group.ecs_sg.id","aws_security_group.ecs_sg"]},"vpc_id":{"references":["aws_vpc.vpc.id","aws_vpc.vpc"]}},"schema_version":1},{"address":"aws_subnet.pub2_subnet","mode":"managed","type":"aws_subnet","name":"pub2_subnet","provider_config_key":"aws","expressions":{"availability_zone":{"constant_value":"us-east-1a"},"cidr_block":{"constant_value":"10.0.2.0/24"},"vpc_id":{"references":["aws_vpc.vpc.id","aws_vpc.vpc"]}},"schema_version":1},{"address":"aws_subnet.pub_subnet","mode":"managed","type":"aws_subnet","name":"pub_subnet","provider_config_key":"aws","expressions":{"availability_zone":{"constant_value":"us-east-1b"},"cidr_block":{"constant_value":"10.0.1.0/24"},"vpc_id":{"references":["aws_vpc.vpc.id","aws_vpc.vpc"]}},"schema_version":1},{"address":"aws_vpc.vpc","mode":"managed","type":"aws_vpc","name":"vpc","provider_config_key":"aws","expressions":{"cidr_block":{"constant_value":"10.0.0.0/16"},"enable_dns_hostnames":{"constant_value":true},"enable_dns_support":{"constant_value":true}},"schema_version":1},{"address":"data.aws_iam_policy_document.ecs_agent","mode":"data","type":"aws_iam_policy_document","name":"ecs_agent","provider_config_key":"aws","expressions":{"statement":[{"actions":{"constant_value":["sts:AssumeRole"]},"principals":[{"identifiers":{"constant_value":["ec2.amazonaws.com"]},"type":{"constant_value":"Service"}}]}]},"schema_version":0},{"address":"data.template_file.task_definition_template","mode":"data","type":"template_file","name":"task_definition_template","provider_config_key":"template","expressions":{"template":{},"vars":{"references":["aws_ecr_repository.worker.repository_url","aws_ecr_repository.worker"]}},"schema_version":0}]}}}
